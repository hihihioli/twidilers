{% extends 'base.html' %}
{% block title %}Settings{% endblock %}
{% block content %}
{% set account = findAccount() %}
    <!-- A submenu that shows different settings -->
    <div id="acct-navbar">
        <button class="pf-mnu-btn" id="acct-dtl-btn" onclick="accountDetail()">Account Details</button>
        <button class="pf-mnu-btn" id="security-btn" onclick="securityDetail()">Security</button>
        <button class="pf-mnu-btn" id="privacy-btn" onclick="privacyDetail()">Privacy</button>

    </div>
    <div id="acct-dtl-content">
        <!-- Header with profile picture and username -->
        <div class="profile-div" id="pfp-head">
            <img src="{{ url_for('.get_pfp',username=account.username) }}" id="pfp">
            <h1 name="prof-username" id="prof-username">{{account.username}}</h1><br>
        </div>
        <!-- Popup Form to upload profile picture -->
        <div class="profile-div">
            <div class="popup-overlay" id="popup">
                Upload a profile picture
                <form method="post" enctype="multipart/form-data" id="upload_pfp">
                    <label for="file" class="custom-file-upload">
                        Choose an Image
                    </label>
                    <input type="file" id="file" name="file" accept="image/*">
                </form>
            </div>
        </div>
        <!-- Log out button -->
        <div class="profile-div">
            <a href="{{ url_for('.logout') }}"><button class="submit">Log out</button></a>
            <form method="post">
                <button class="submit" id="prof-delete-account" name="delete">Delete Account</button>
            </form> 
        </div>        
        <!-- Delete account button -->

    </div>
    <div id="security-content">
        security content
    </div>
    <div id="privacy-content">
        privacy content
    </div>
        <script>
        // Popup form for profile image upload
            const accountInfo = document.getElementById('acct-dtl-content');
            const security = document.getElementById('security-content');
            const privacy = document.getElementById('privacy-content')

            function accountDetail() {
                accountInfo.style.display = 'flex';
                security.style.display = 'none';
                privacy.style.display = 'none';
            }
            function securityDetail() {
                accountInfo.style.display = 'none';
                security.style.display = 'flex';
                privacy.style.display = 'none';
            }
            function privacyDetail() {
                accountInfo.style.display = 'none';
                security.style.display = 'none';
                privacy.style.display = 'flex';
            }
                       
            // Submits the image
            file = document.getElementById('file');
            file.addEventListener('change',() => {
                if(file.files.length > 0){
                    document.getElementById('upload_pfp').submit();
                }
            })</script>

{% endblock %}